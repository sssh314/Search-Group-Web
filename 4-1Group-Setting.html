<!DOCTYPE html>
<html lang="ko">
<head>
    <script>
        function Onmousein(button){
            button.style.backgroundColor = "#404040";
        }

        function Onmouseout(button){
            button.style.backgroundColor = "#212121";
        }
        function goMain(){
          location.href = "2-1Search-Main.html";
        }
        function selectLocation() {
            const groupId = getGroupIdFromURL();
            window.location.href = `4-1-1EditLocation.html?group_id=${groupId}`;
        }

        // 기존 그룹 배열 가져오기
        let groups = JSON.parse(localStorage.getItem("groups")) || [];

        // url에서 group_id 가져오기 
        function getGroupIdFromURL(){
            const params = new URLSearchParams(location.search);
            return params.get("group_id");
        }

        window.onload = function(){
            // 그룹 ID 가져오기
            const groupId = getGroupIdFromURL();
            if(!groupId){
                alert("잘못된 접근입니다. group_id가 없습니다.");
                return;
            }

            // 해당 그룹 찾기 
            let groupData = groups.find(g => g.id == groupId);

            if(!groupData){
                alert("해당 그룹을 찾을 수 없습니다.");
                return;
            }

            // group에 저장된 값으로 채우기 
            document.querySelector(".group-name input").value = groupData.name || "";
            document.querySelector(".group-maxPeople input").value = groupData.maxPeople || "";
            document.querySelector(".group-time input").value = groupData.time || "";
            document.querySelector(".group-date input").value = groupData.date || "";
            document.querySelector(".group-location input").value = groupData.location || "";
            document.getElementById("group-notice").value = groupData.notice || "";
        }

        // 저장 
        function saveEditedGroup(){
            const groupId = getGroupIdFromURL();
            let groups = JSON.parse(localStorage.getItem("groups")) || [];
            let groupData = groups.find(g => g.id == groupId);

            if(!groupData){
                alert("해당 그룹을 찾을 수 없습니다.");
                return;
            }

            const name = document.querySelector(".group-name input").value.trim();
            const maxPeople = Number(document.querySelector(".group-maxPeople input").value.trim());
            const time = document.querySelector(".group-time input").value.trim();
            const date = document.querySelector(".group-date input").value.trim();
            const location = document.querySelector(".group-location input").value.trim();
            const notice = document.getElementById("group-notice").value.trim();
            


            if(!name || !maxPeople || !time || !date || !location){
                alert("모든 필드를 입력해주세요!");
                return;
            }
            if (isNaN(maxPeople) || maxPeople <= 0) {
                alert("최대 인원 수가 올바르지 않습니다.");
                return;
            }

            groupData.name = name;
            groupData.maxPeople = maxPeople;
            groupData.time = time;
            groupData.date = date; 
            groupData.location = location; 
            groupData.notice = notice;

            

            localStorage.setItem("groups", JSON.stringify(groups)); // 다시 저장

            alert("저장되었습니다.")
        }   

        function success(){
            const groupId = getGroupIdFromURL();
            location.href = `3-1Group-Main.html?group_id=${groupId}`;

        }
    </script>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>스터디 모임 플랫폼</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    padding-bottom: 70px;
    background: #212121;
  }

  header {
    background-color: #212121;
    color: white;
    padding: 20px;
    display: flex;
    justify-content: space-between;
  }

  header h1 {
    margin: 0;
    cursor: pointer;
  }

  header button {
    background-color: #212121;
    color: white;
    border: none;
    padding: 10px 15px;
    border-radius: 20px;
    cursor: pointer;
    font-weight: bold;
  }
  .container {
    max-width: 1000px;
    margin: 30px auto;
    padding: 0 20px;
  }
  .top-controls {
    display: flex;
    margin-bottom: 20px;
    flex-wrap: wrap;
    gap: 10px;
  }
  .group-top{
    display: flex;
    flex: 1;
    color: white;
    size: 1rem;
    justify-content:space-between;
  }
  .group-top h1{
    margin: 0;
  }
  .group-top button{
    background-color: #212121;
    color: white;
    border-radius: 20px;
    border: none;
    padding: 10px 15px;
    cursor: pointer;
  }
  .group-setting{
    color: white;
    margin-top: 60px;
  }
  .group-name{
    margin-bottom: 30px;
    background-color: #171717;
    border-radius: 15px;
    padding: 20px;
  }
  .group-name h3{
    margin-top: 0;
  }
  .group-name input{
    flex: 1;
    padding: 10px;
    font-size: 1rem;
    color: white;
    border: 1px solid #404040;
    border-radius: 10px;
    outline: none;
    background: #303030;
  }
  .group-maxPeople{
    margin-bottom: 30px;
    background-color: #171717;
    border-radius: 15px;
    padding: 15px;
  }
  .group-maxPeople h3{
    margin-top: 0;
  }
  .group-maxPeople input{
    flex: 1;
    padding: 10px;
    font-size: 1rem;
    color: white;
    border: 1px solid #404040;
    border-radius: 10px;
    outline: none;
    background: #303030;
  }
  .group-time{
    margin-bottom: 30px;
    background-color: #171717;
    border-radius: 15px;
    padding: 15px;
  }
  .group-time h3{
    margin-top: 0;
  }
  .group-time input{
    flex: 1;
    padding: 10px;
    font-size: 1rem;
    color: white;
    border: 1px solid #404040;
    border-radius: 10px;
    outline: none;
    background: #303030;
  }
  .group-date{
    margin-bottom: 30px;
    background-color: #171717;
    border-radius: 15px;
    padding: 15px;
  }
  .group-date h3{
    margin-top: 0;
  }
  .group-date input{
    flex: 1;
    padding: 10px;
    font-size: 1rem;
    color: white;
    border: 1px solid #404040;
    border-radius: 10px;
    outline: none;
    background: #303030;
  }
  .group-location{
    margin-bottom: 30px;
    background-color: #171717;
    border-radius: 15px;
    padding: 15px;
  }
  .group-location h3{
    margin-top: 0;
  }
  .group-location input{
    flex: 1;
    padding: 10px;
    font-size: 1rem;
    color: white;
    border: 1px solid #404040;
    border-radius: 10px;
    outline: none;
    background: #303030;
    width: 98%;
  }
  .group-tag{
    margin-bottom: 30px;
    background-color: #171717;
    border-radius: 15px;
    padding: 15px;
  }
  .group-tag h3{
    margin-top: 0;
  }
  .group-tag input{
    flex: 1;
    padding: 10px;
    font-size: 1rem;
    color: white;
    border: 1px solid #404040;
    border-radius: 10px;
    outline: none;
    background: #303030;
    width: 98%;
  }
</style>
</head>
<body>

<header>
  <h1 onclick="goMain()">모임 찾기</h1>
  <button onmouseover="Onmousein(this)" onmouseout="Onmouseout(this)">마이페이지</button>
</header>

<div class="container">
    <div class="top-controls">
        <div class="group-top">
            <h1>모임 편집</h1>
            <div>
              <button onclick="saveEditedGroup()" onmouseover="Onmousein(this)" onmouseout="Onmouseout(this)">저장</button>
              <button onclick="success()" onmouseover="Onmousein(this)" onmouseout="Onmouseout(this)">완료</button>
            </div>
        </div>
    </div>
    <div class="group-setting">
      <div class="group-name">
        <h3>모임 이름</h3>
        <input type="text">
      </div>
      <div class="group-maxPeople">
        <h3>모임 인원 수</h3>
        <input type="number">
      </div>
      <div class="group-time">
        <h3>모임 시간</h3>
        <input type="time">
      </div>
      <div class="group-date">
        <h3>모임 날짜</h3>
        <input type="date">
      </div>
      <div class="group-location">
        <h3>모임 장소</h3>
        <div style="display: flex; gap: 10px;">
            <input type="text" id="group-location-input" placeholder="장소 선택" readonly style="flex:1;">
            <button onclick="selectLocation()" style="padding:10px; border-radius:10px; border:none; background:#404040; color:white; cursor:pointer;">장소 선택</button>
        </div>
      </div>
      <div class="group-tag">
        <h3>공지사항</h3>
        <textarea id="group-notice" rows="4"
          style="width:98%; background:#303030; color:white;
                border:1px solid #404040; border-radius:10px;
                padding:10px; resize:none;"></textarea>
      </div>
    </div>
</div>
</body>
</html>